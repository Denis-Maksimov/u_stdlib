#############################################################

TARGET:= ./run



##############################################################
# Исходники
##############################################################


SRC := ./src/u_mallocat.c
SRC += ./src/u_string.c
SRC += ./src/u_chain.c
#----------------------
SRC += ./u_test.c
SRC += ./main.c


INC := ./inc
INC += ./inc/u_mallocat

##############################################################
# Компилятор
##############################################################
CC:=gcc
# CC:=avr-gcc
# CC:=arm-none-eabi-gcc

##############################################################
#flags
CFLAGS:= -O2 -Wall $(addprefix -I,$(INC) )

# если не поддерживается деление
# CFLAGS+=-DNO_DIVISION




##############################################################




# блобы рядом с исходниками:

OBJS :=$(SRC:%.c=%.o)

#скрыть весь ужас
.SILENT:




###############################################################################	
# Сборка исполняемого файла
###############################################################################
$(TARGET): $(OBJS)
	$(CC) $(OBJS) $(LIBS) -o $(TARGET)
	echo "Компиляция $(TARGET) завершена"
	size $(TARGET)
	
###############################################################################	
# Шаблон компиляции как из *.с получить *.о 
###############################################################################		

%.o: %.cpp #$(OBJDIRS)
	$(CC) -c   $(CFLAGS) -o $@


###############################################################################	
# Чистка
###############################################################################
clean: 
	rm -frv $(OBJS)

